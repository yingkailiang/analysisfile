var minWidth=100;Element.prototype.__getElements=Element.prototype.querySelectorAll;Element.prototype.__getElement=Element.prototype.querySelector;String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")};(function(){var global="__huaban";document[global]=document[global]||{};var siteDomain="huaban.com";var imageRoot="http://"+siteDomain+"/img";var bookmarkletUrl="http://"+siteDomain+"/bookmarklet/";var analyticsUrl="http://"+siteDomain+"/share_analytics.html";var domChanged=false;var selectedText="";var lastScrollY=0;var isShareBtn=false;var isLogin=false;var btnPositions=["top","left"];var pinBtn=null;var thunderpinBtn=null;var hidePinBtnTimer=null;var xdm;var currentImage=null;var imageDesc="";var showingImage=false;var isToggleOn=true;var itemUrl="";var skip=false;var skiphrefs=["http://www.diandian.com/wall"];(function(){for(var i=0;i<skiphrefs.length;i++){if(location.href.indexOf(skiphrefs[i])>=0){skip=true;break}}})();var important=false;var importantCssWebsites=["faxianla.com"];(function(){for(var i=0;i<importantCssWebsites.length;i++){if(location.href.indexOf(importantCssWebsites[i])>=0){important=true;break}}})();var checkbgimgs=function(el){var c=el;if(!c){return}var bgimg=c.style.backgroundImage||c.style.getPropertyValue&&c.style.getPropertyValue("background-image");if(!bgimg){return}var result=bgimg.match(/url\((.+)\)/);if(result==null||result.length!=2){return}var bg_url=result[1];if(bg_url.indexOf("http://")==0||bg_url.indexOf("https://")==0||bg_url.indexOf("/")==0){var img=new Image();img.src=bg_url;var obj={container:c,w:img.naturalWidth||img.width,h:img.naturalHeight||img.height,src:img.src,img:img,alt:"",};return obj}else{}return};var bgimgs={"^http://1x\\.com/":function(){var img=checkbgimgs(document.getElementById("bigimage2"));if(img){return[img]}return},"^http://\\w+\\.163\\.com/photoview/":function(){var modephoto=document.getElementById("modePhoto");if(!modephoto){return}var img=modephoto.__getElement("#photoView img");var preview=modephoto.__getElement(".nph_photo_prev");var desc=modephoto.__getElement("#photoDesc");var title=document.title||"";title=title+"\n";if(img&&preview){return[{container:preview,w:img.naturalWidth||img.width,h:img.naturalHeight||img.height,src:img.src,img:img,description:title+(desc&&desc.innerText||""),}]}return},"^http://luxury\\.qq\\.com/":function(){var main_a=document.getElementById("Main-A");var main_area=document.getElementById("mainArea");var img,preview,desc,title=document.title||"";if(main_a){img=main_a.__getElement("#PicSrc");preview=main_a.__getElement("#mouseOverleft");desc=document.body.__getElement("#Main-B > p");if(desc){desc=desc.innerText||""}}if(main_area){img=document.getElementById("Display");preview=document.getElementById("preArrow");desc=main_area.__getElement("#titleArea > p");if(desc){desc=desc.innerText||""}}title=title+"\n";if(img&&preview){return[{container:preview,w:img.naturalWidth||img.width,h:img.naturalHeight||img.height,src:img.src,img:img,description:title+desc,}]}return},"^http(s)?://slide\\.news\\.sina\\.com\\.cn/":function(){var container=document.getElementById("efpBigPic");var desc_c=document.getElementById("efpTxt");if(!container){return}var img=container.__getElement("#d_BigPic img");var preview=container.__getElement("#efpLeftArea");var desc=desc_c&&desc_c.__getElement("#efpTxt > #d_picIntro")||"";var title=document.getElementById("d_picTit");title=title?title.innerHTML:document.title||"";desc=desc?desc.innerHTML:"";if(img&&preview){return[{container:preview,w:img.naturalWidth||img.width,h:img.naturalHeight||img.height,src:img.src,img:img,description:(title+"\n"+desc).trim(),}]}return},"^http://\\w+\\.flickr\\.com/":function(){var container=document.getElementById("photo");if(!container){return}var img=container.__getElement("img");var preview=container.__getElement("#photo-drag-proxy");var title=document.title||"";var images=[];if(img&&preview){images.push({container:preview,w:img.width,h:img.height,src:img.src,img:img,description:title.trim(),})}container=document.getElementById("lightbox");if(container){var li=container.__getElements("li");for(var i=0;i<li.length;i++){var node=li[i];img=node.__getElement("img.loaded");preview=node.__getElement("span.facade-of-protection");if(img&&preview){images.push({container:preview,w:img.width,h:img.height,src:img.src,img:img,description:title.trim(),})}}}return images}};var filters={"^http(s)?://(\\w+.)?diandian\\.com":function(obj){var el=obj.img;var link=null;var title=null;var description=null;if(tagName(el)=="img"){el=el.parentNode;var b_flag=false;while(el&&el.nodeName.toLowerCase()!="body"){var cls=getClass(el);if(cls=="feed-content-holder pop"){var anchor=el.__getElement("div.link-to-post-holder a.link-to-post");if(anchor){link=anchor.getAttribute("href");b_flag=true}var desc=el.__getElement("div.feed-ct");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}else{if(cls="radar-img-holder"&&tagName(el)=="a"){link=el.getAttribute("href");b_flag=true}}if(b_flag){break}el=el.parentNode||null}}if(link){obj.url=getHref(link)}if(title){obj.title=title}if(description){obj.description=description}return obj},"^http://(.*\\.)?weibo\\.com":function(obj){var el=obj.img;var link=null;var description=null;var title=null;if(tagName(el)=="img"&&getAttribute(el,"action-type")=="feed_list_media_bigimg"){el=el.parentNode;var b_flag=false;while(el&&el.nodeName.toLowerCase()!="body"&&!(tagName(el)=="dl"&&hasClass(el,"feed_list"))){if(tagName(el)=="dd"&&hasClass(el,"content")){b_flag=true;var anchor=el.__getElement("a[node-type=feed_list_item_date]");if(anchor){link=anchor.getAttribute("href")||""}var desc=el.__getElement("p[node-type=feed_list_content]");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}else{if(tagName(el)=="div"&&hasClass(el,"WB_detail")){b_flag=true;var func;var funcs=el.__getElements("div.WB_func");for(var i=0;i<funcs.length;i++){var tempParent=funcs[i].parentNode;if(tagName(tempParent)=="div"&&hasClass(tempParent,"WB_detail")){func=funcs[i]}}if(func){var anchor=func.__getElement("a[node-type=feed_list_item_date]");if(anchor){link=anchor.getAttribute("href")||""}var desc=el.__getElement("div[node-type=feed_list_content]");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}}}if(b_flag){break}el=el.parentNode||null}}else{if(tagName(el)=="img"&&getAttribute(el,"node-type")=="feed_list_media_bgimg"){el=el.parentNode;var b_flag=false;while(el&&el.nodeName.toLowerCase()!="body"&&!(tagName(el)=="dl"&&hasClass(el,"feed_list"))){if(tagName(el)=="div"&&hasClass(el,"WB_detail")){b_flag=true;var func;var funcs=el.__getElements("div.WB_func");for(var i=0;i<funcs.length;i++){var tempParent=funcs[i].parentNode;if(tagName(tempParent)=="div"&&hasClass(tempParent,"WB_detail")){func=funcs[i]}}if(func){var anchor=func.__getElement("a[node-type=feed_list_item_date]");if(anchor){link=anchor.getAttribute("href")||""}var desc=el.__getElement("div[node-type=feed_list_content]");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}}if(b_flag){break}el=el.parentNode||null}}else{if(tagName(el)=="img"&&getAttribute(el,"node-type")=="img_view"){el=el.parentNode&&el.parentNode.parentNode||null;if(el&&hasClass(el,"big_pic")&&getAttribute(el,"node-type")=="layer_center"){var anchor=el.__getElement("p[node-type=feed_list_content] a[node-type=feed_list_item_date]");if(anchor){link=anchor.getAttribute("href")||""}var desc=el.__getElement("p[node-type=feed_list_content]");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}}else{if(tagName(el)=="img"&&el.parentNode&&el.parentNode.parentNode&&el.parentNode.parentNode.parentNode&&getAttribute(el.parentNode.parentNode.parentNode,"node-type")=="albumDetail"){var container=el.parentNode.parentNode.parentNode;var anchor=tagName(el.parentNode)=="a"?el.parentNode:false;if(anchor){link=anchor.getAttribute("href")||""}var desc=container&&container.__getElement(".photo_comment > div > p");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}}}}if(obj.container&&(tagName(obj.container)=="embed"||tagName(obj.container)=="object")){el=obj.container;var b_flag=false;while(tagName(el)!="body"){if(getAttribute(el,"node-type")=="feed_list_media_bigvideoDiv"||getAttribute(el,"note-type")=="feed_list_media_bigvideoDiv"){el=el.parentNode&&el.parentNode.parentNode&&el.parentNode.parentNode.parentNode;b_flag=true;if(!el){break}var anchor=el.__getElement("p[node-type=feed_list_content]~p a[node-type=feed_list_item_date]");if(anchor){link=anchor.getAttribute("href")||""}else{anchor=el.__getElement("div[node-type=feed_list_reason]~div a[node-type=feed_list_item_date]");if(!anchor){anchor=el.__getElement("div[node-type=feed_list_content]~div a[node-type=feed_list_item_date]")}if(anchor){link="http://weibo.com"+anchor.getAttribute("href")||""}}var desc=el.__getElement("p[node-type=feed_list_content]");if(!desc){desc=el.__getElement("div[node-type=feed_list_reason]")}if(!desc){desc=el.__getElement("div[node-type=feed_list_content]")}if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}if(b_flag){break}el=el.parentNode||null}}if(link){obj.url=getHref(link)}if(title){obj.title=title}if(description){obj.description=description}return obj},"^http(s)?://www\\.google\\.com/reader/":function(obj){var el=obj.img;var link=null;var description=null;var title=null;if(tagName(el)=="img"){el=el.parentNode;var b_flag=false;while(el&&el.nodeName.toLowerCase()!="body"&&!(tagName(el)=="div"&&hasClass(el,"entry-container"))){if(tagName(el)=="div"&&hasClass(el,"entry-main")){b_flag=true;var anchor=el.__getElement("h2.entry-title a.entry-title-link");if(anchor){link=anchor.getAttribute("href")||"";description=anchor.innerText||anchor.textContent||"";description=description.trim();title=description}}if(b_flag){break}el=el.parentNode||null}}if(link){obj.url=getHref(link)}if(title){obj.title=title}if(description){obj.description=description}},"^http(s)?://(www\\.)?(markzhi|faxianla)\\.com":function(obj){var el=obj.img;var link=null;var description=null;var title=null;var img_url=null;if(tagName(el)=="img"&&el.parentNode&&el.parentNode.parentNode&&hasClass(el.parentNode.parentNode,"item")&&hasClass(el.parentNode.parentNode,"mark")){var new_img_url=getAttribute(el,"src");if(new_img_url&&/metal.jpg$/.test(new_img_url)){img_url=new_img_url.replace(/metal.jpg$/,"wood.jpg")}if(new_img_url&&/\/metal\//.test(new_img_url)){img_url=new_img_url.replace(/\/metal\//,"/wood/")}el=el.parentNode;var anchor=null;if(tagName(el)=="a"&&hasClass(el,"image")){link=getAttribute(el,"href")}el=el.parentNode;var title_el=el.__getElement("strong.title");if(title_el){title=title_el.innerText||title_el.textContent||"";title=title.trim()}}if(link){obj.url=getHref(link)}if(title){obj.title=title}if(description){obj.description=description}if(img_url){var new_img=new Image();new_img.alt=obj.img.alt;new_img.src=img_url;obj.big_img=new_img}},"^http(s)?://plus\\.google\\.com/":function(obj){var el=obj.img;var link=null;if(itemUrl){link=itemUrl}if(el.parentNode){var data_content_url=getAttribute(el.parentNode,"data-content-url");if(data_content_url&&/http(s)?:\/\/plus.google.com\/photos\/.+\/albums\/.+/.test(data_content_url)){link=data_content_url}}if(link){obj.url=getHref(link)}},"^http(s)?://(www\\.)?tumblr\\.com":function(obj){var el=obj.img;var link=null;var description=null;if(tagName(el)=="img"){el=el.parentNode;var b_flag=false;while(el&&el.nodeName.toLowerCase()!="body"){if(tagName(el)=="li"&&hasClass(el,"post")&&el.id&&el.id.indexOf("post_")==0){b_flag=true;var anchor=el.__getElement("a.permalink");if(anchor){link=anchor.getAttribute("href")||""}var desc=el.__getElement("div.caption > p");if(desc){description=desc.innerText||desc.textContent||"";description=description.trim()}}if(b_flag){break}el=el.parentNode||null}}if(link){obj.url=getHref(link)}if(description){obj.description=description}},"^http(s)?://(www\\.)?topit\\.me":function(obj){var el=obj.img;var link=null;var title=null;var img_url=null;if(tagName(el)=="img"){el=el.parentNode;var b_flag=false;while(el&&el.nodeName.toLowerCase()!="body"){if(tagName(el)=="div"&&hasClass(el,"e")&&hasClass(el,"m")){b_flag=true;var anchor=obj.img.parentNode;link=anchor.getAttribute("href")||"";var t=el.__getElement(".bar > .title");title=t&&t.innerText||t.textContent||"";t=el.__getElement(".bar > .info");title=t&&title&&title.trim()+"\n";title+=t&&t.innerText||t.textContent||"";title=title.trim();var new_img_url=getAttribute(obj.img,"src");if(new_img_url){if(/m\.jpg$/.test(new_img_url)){img_url=new_img_url.replace(/m\.jpg$/,"l.jpg")}else{if(/topit\.me\/m\d+\//.test(new_img_url)){img_url=new_img_url.replace(/(topit\.me\/)m(\d+\/)/,"$1l$2")}else{if(/img\.topit\.me\/m\//.test(new_img_url)){img_url=new_img_url.replace(/(img\.topit\.me\/)m(\/)/,"$1l$2")}}}}}if(b_flag){break}el=el.parentNode||null}}if(link){obj.url=getHref(link)}if(title){obj.description=title}if(img_url){var new_img=new Image();new_img.alt=obj.img.alt;new_img.src=img_url;obj.big_img=new_img}},"^http(s)?://(www.)?woxihuan.com/":function(obj){var el=obj.img;var link=null;var description=null;var title=null;var img_url=null;if(tagName(el)=="img"&&el.parentNode&&el.parentNode.parentNode&&el.parentNode.parentNode.parentNode&&hasClass(el.parentNode.parentNode.parentNode,"cellItem")){var new_img_url=getAttribute(el,"src");if(new_img_url&&/\/196__\//.test(new_img_url)){img_url=new_img_url.replace(/\/196__\//,"/680__/")}el=el.parentNode;var anchor=null;if(tagName(el)=="a"&&getAttribute(el,"module-tag")){link=getAttribute(el,"href")}el=el.parentNode.parentNode;var title_el=el.__getElement("h3 span.cellTit");if(title_el){title=title_el.innerText||title_el.textContent||"";title=title.trim()}}if(link){obj.url=getHref(link)}if(title){obj.title=title}if(description){obj.description=description}if(img_url){var new_img=new Image();new_img.alt=obj.img.alt;new_img.src=img_url;obj.big_img=new_img}}};function getHref(href){href=href||"";if(href.indexOf("//")==0){href=location.protocol+href}else{if(href.indexOf("http")<0){href=location.protocol+"//"+location.hostname+href}}return href}function getAttribute(el,name){return el&&el.getAttribute&&el.getAttribute(name)||""}function getClass(el){return getAttribute(el,"class")}function hasClass(el,cls){var clses=getClass(el);clses=clses.trim().split(/\s+/);var tmp_cls=null;while(clses&&clses.shift&&(tmp_cls=clses.shift()),tmp_cls){if(tmp_cls==cls){return true}}return false}function tagName(el){return(el&&el.tagName||"").toLowerCase()}function registerImagesForPinBtn(eImages){for(var i=0;i<eImages.length;i++){registerImageForPinBtn(eImages[i])}}var isShowedBtn=false;function registerImageForPinBtn(eImage){var originImg=eImage.container||eImage.img;if(originImg&&!originImg.getAttribute("data-pinit")){originImg.setAttribute("data-pinit","registered");var eventHandlers=[originImg.onmouseover||function(){},originImg.onmouseout||function(){},originImg.onmousemove||function(){}];originImg.onmouseover=function(e){getToggleOn(function(isToggleOn){if(isToggleOn&&!isShowedBtn){isShowedBtn=true;showPinBtn(eImage)}});return eventHandlers[0].call(originImg,e)};originImg.onmouseout=function(e){hidePinBtn();isShowedBtn=false;return eventHandlers[1].call(originImg,e)};originImg.onmousemove=function(e){getToggleOn(function(isToggleOn){if(isToggleOn&&!isShowedBtn){isShowedBtn=true;showPinBtn(eImage)}});return eventHandlers[2].call(originImg,e)}}}function generatePinBtn(){if(!document.getElementById(global+"_Button")){pinBtn=generateTag("Button","pinit");pinBtn.onmouseover=function(){selectedText=getSelectedText();showPinBtn()};pinBtn.onmouseout=function(){hidePinBtn()};if(isShareBtn){pinBtn.onclick=function(){currentImage&&pinImage(currentImage);selectedText="";itemUrl="";return false}}else{var _thunderpinbtn=generateTag("thunderpinBtn","a");_thunderpinbtn.href="#";_thunderpinbtn.title="快速采集";_thunderpinbtn.onclick="return false;";_thunderpinbtn.innerHTML="<strong><em></em></strong>";var _pinBtn=generateTag("pinBtn","a");_pinBtn.href="#";_pinBtn.title="采集到花瓣";_pinBtn.onclick="return false;";_pinBtn.innerHTML="采集到花瓣";if(isIE()){_thunderpinbtn.className="thunderpin";_pinBtn.className="pin"}else{_thunderpinbtn.setAttribute("class","thunderpin");_pinBtn.setAttribute("class","pin")}pinBtn.appendChild(_thunderpinbtn);pinBtn.appendChild(_pinBtn);pinBtn.style.display="none";_pinBtn.onclick=function(){currentImage&&pinImage(currentImage);selectedText="";itemUrl="";return false};_thunderpinbtn.onclick=function(){var position={top:pinBtn.style.top,left:pinBtn.style.left};currentImage&&thunderpinImage(currentImage,null,position,function(){selectedText="";itemUrl=""});return false}}document.body.appendChild(pinBtn)}else{pinBtn=document.getElementById(global+"_Button")}var position_prefix=global+"_Button_";if(isShareBtn&&pinBtn){position_prefix=global+"_Button_share_";var pos_x=position_prefix+(~btnPositions.indexOf("rigth")?" right":"left");var pos_y=position_prefix+(~btnPositions.indexOf("bottom")?"bottom":"top");if(isIE()){pinBtn.className=global+"_Button_share "+pos_x+" "+pos_y}else{pinBtn.setAttribute("class",global+"_Button_share "+pos_x+" "+pos_y)}}}function showPinBtn(eImage){clearTimeout(hidePinBtnTimer);var x_pos=~btnPositions.indexOf("right")?"right":"left";var y_pos=~btnPositions.indexOf("bottom")?"bottom":"top";if(eImage){var originImg=eImage.container||eImage.img;var left,top;top=left=0;currentImage=eImage;if(originImg.getBoundingClientRect){var documentElement=document.documentElement;var rect_originImg=originImg.getBoundingClientRect();var documentTop=documentElement.clientTop||document.body.clientTop||0;var offsetY=window.pageYOffset||document.body.scrollTop;var _offsetTop=0;var _offsetLeft=0;if(currentImage._parentNode){_offsetTop=currentImage._parentNode.offsetTop||0;_offsetLeft=currentImage._parentNode.offsetLeft||0}left=rect_originImg.left+(window.pageXOffset||document.body.scrollLeft)-(documentElement.clientLeft||document.body.clientLeft||0)+_offsetLeft;top=rect_originImg.top+offsetY-documentTop+_offsetTop;if(x_pos=="right"){left+=rect_originImg.width?(rect_originImg.width-86):(originImg.width-86)}if(y_pos=="bottom"){top+=rect_originImg.height?(rect_originImg.height-24):(originImg.height-24)}}if(y_pos=="bottom"){top+=24}else{top-=isShareBtn?24:26}if(x_pos=="right"){left+=isShareBtn?6:-16}else{left-=isShareBtn?0:2}pinBtn.style.top=(top>0?top:0)+"px";pinBtn.style.left=(left>0?left:0)+"px";if(important){var _style=" top:"+(top>0?top:0)+"px !important; left:"+(left>0?left:0)+"px !important;";pinBtn.setAttribute("style",_style)}}pinBtn.style.display="block";pinBtn.style.visibility="visible";pinBtn.style.display="block !important";pinBtn.style.visibility="visible !important";if(important){var _style=pinBtn.getAttribute("style")+(isIE()?";":"")+" display: block !important; visibility: visible !important;";pinBtn.setAttribute("style",_style)}}function hidePinBtn(){hidePinBtnTimer=setTimeout(function(){pinBtn.style.display="none";pinBtn.style.visibility="hidden";pinBtn.style.display="none !important";pinBtn.style.visibility="hidden !important";if(important){var _style=" display: none !important; visibility: hidden !important;";pinBtn.setAttribute("style",_style)}currentImage=null},100)}function calculateMarginTop(eImage){if(Math.max(eImage.h,eImage.w)>199){if(eImage.h<eImage.w){return"margin-top: "+parseInt(100-100*(eImage.h/eImage.w))+"px;"}return""}else{return"margin-top: "+parseInt(100-eImage.h/2)+"px;"}}function generateStyleElement(){var styleId=global+"_Style";if(document.getElementById(styleId)){return}var styles="#PREFIX_Container {font-family: 'helvetica neue', arial, sans-serif; position: absolute; padding-top: 37px; z-index: 100000002; top: 0; left: 0; background-color: transparent; opacity: 1;hasLayout:-1;}#PREFIX_Overlay {position: fixed; z-index: 100000001; top: 0; right: 0; bottom: 0; left: 0; background-color: #f2f2f2; opacity: .95;}* html #PREFIX_Overlay {position: absolute;}#PREFIX_Control {position:relative; z-index: 100000; float: left; background-color: #fcf9f9; border: solid #ccc; border-width: 0 1px 1px 0; height: 200px; width: 200px; opacity: 1;}* html #PREFIX_Control {position:static;}#PREFIX_Control img {position: relative; padding: 0; display: block; margin: 82px auto 0; -ms-interpolation-mode: bicubic;}#PREFIX_Control a {position: fixed; z-index: 10001; right: 0; top: 0; left: 0; height: 24px; padding: 12px 0 0; text-align: center; font-size: 14px; line-height: 1em; text-shadow: 0 1px #fff; color: #211922; font-weight: bold; text-decoration: none; background: #fff url(ASSETS_URL/fullGradient07Normal.png) 0 0 repeat-x; border-bottom: 1px solid #ccc; -mox-box-shadow: 0 0 2px #d7d7d7; -webkit-box-shadow: 0 0 2px #d7d7d7;}* html #PREFIX_Control a {position: absolute; width: 100%;}#PREFIX_Control a:hover {color: #fff; text-decoration: none; background-color: #1389e5; border-color: #1389e5; text-shadow: 0 -1px #46A0E6;}#PREFIX_Control a:active {height: 23px; padding-top: 13px; background-color: #211922; border-color: #211922; background-image: url(ASSETS_URL/fullGradient07Inverted.png); text-shadow: 0 -1px #211922;}.PREFIXImagePreview {position: relative; padding: 0; margin: 0; float: left; background-color: #fff; border: solid #e7e7e7; border-width: 0 1px 1px 0; height: 200px; width: 200px; opacity: 1; z-index: 10002; text-align: center; overflow:hidden;}.PREFIXImagePreview .PREFIXVideoIcon {position:absolute;display:block;top:0;left:0;width:100%;height:100%;background:url(ASSETS_URL/media_video.png) center center no-repeat;}.PREFIXImagePreview .PREFIXImg {border: none; height: 200px; width: 200px; opacity: 1; padding: 0; position: absolute; top: 0;}.PREFIXImagePreview .PREFIXImg a {margin: 0; padding: 0; position: absolute; top: 0; bottom: 0; right: 0; left: 0; display: block; text-align: center;  z-index: 1;}.PREFIXImagePreview .PREFIXImg a:hover {background-color: #fcf9f9; border: none;}.PREFIXImagePreview .PREFIXImg .ImageToPin {max-height: 200px; max-width: 200px; width: auto !important; height: auto !important;}.PREFIXImagePreview img.PREFIX_PinIt {border: none; position: absolute; top: 82px; left: 42px; display: none; padding: 0; background-color: transparent; z-index: 100;}.PREFIXImagePreview strong {text-indent: -9999px; position: absolute; top: 82px; display: none; height: 32px; background: url(ASSETS_URL/bm_pin_sprite.png?20120801) no-repeat 0 0;}.PREFIXImagePreview strong.PREFIX_ThunderPin {width: 24px; left: 52px; background-position: 0 0;}.PREFIXImagePreview strong.PREFIX_ThunderPin:hover {background-position: 0 -50px;}.PREFIXImagePreview strong.PREFIX_ThunderPin:active {background-position: 0 -100px;}.PREFIXImagePreview strong.PREFIX_Pin {width: 72px; left: 75px; background-position: -40px 0;}.PREFIXImagePreview strong.PREFIX_Pin:hover {background-position: -40px -50px;}.PREFIXImagePreview strong.PREFIX_Pin:active {background-position: -40px -100px;}.PREFIXImagePreview img.PREFIX_vidind {border: none; position: absolute; top: 75px; left: 75px; padding: 0; background-color: transparent; z-index: 99;}.PREFIXDimensions { color: #000; position: relative; margin-top: 180px; text-align: center; font-size: 10px; z-index:10003; display: inline-block; background: white; border-radius: 4px; padding: 0 2px;}#PREFIX_Button, #PREFIX_Button *, #PREFIX_Container, #PREFIX_Container * { -webkit-box-sizing: content-box; -moz-box-sizing: content-box; -ms-box-sizing: content-box; box-sizing: content-box;}#PREFIX_Button { display: block; position: absolute; z-index: 999999999 !important; color: #211922; text-shadow: 0 1px #eaeaea; font: 12px/1 'Helvetica Neue',Helvetica,Arial,Sans-serif; text-align: center; padding: 0; margin: 0; cursor: pointer;}#PREFIX_Button a {text-decoration: none; color: #211922; display: inline-block; text-align: center; line-height: 14px; height: 14px; border-radius: 2px; -webkit-border-radius: 2px; -moz-border-radius: 2px; -ms-border-radius: 2px; -o-border-radius: 2px; cursor: pointer; position: absolute; top: 0; left: 0; height: 14px; margin: 0 2px; padding: 5px 8px; border: 1px solid #555; border: 1px solid rgba(140, 126, 126, .5); background-color: #fff;}#PREFIX_Button a:hover {text-decoration: none; background-image: -webkit-linear-gradient(top, #fefeff, #efefef); background-image: -moz-linear-gradient(top, #fefeff, #efefef); box-shadow: inset 0 1px rgba(255,255,255,0.35), 0 1px 1px rgba(35,24,24,0.75); -o-box-shadow: inset 0 1px rgba(255,255,255,0.35), 0 1px 1px rgba(35,24,24,0.75); -ms-box-shadow: inset 0 1px rgba(255,255,255,0.35), 0 1px 1px rgba(35,24,24,0.75); -moz-box-shadow: inset 0 1px rgba(255,255,255,0.35), 0 1px 1px rgba(35,24,24,0.75); -webkit-box-shadow: inset 0 1px rgba(255,255,255,0.35), 0 1px 1px rgba(35,24,24,0.75);}#PREFIX_Button a:active {text-decoration: none; background-image: -webkit-linear-gradient(top, #fefeff, #efefef); background-image: -moz-linear-gradient(top, #fefeff, #efefef); box-shadow: inset 0 1px 2px rgba(34,25,25,0.25), 0 0 1px rgba(232,230,230,0.5); -o-box-shadow: inset 0 1px 2px rgba(34,25,25,0.25), 0 0 1px rgba(232,230,230,0.5); -ms-box-shadow: inset 0 1px 2px rgba(34,25,25,0.25), 0 0 1px rgba(232,230,230,0.5); -moz-box-shadow: inset 0 1px 2px rgba(34,25,25,0.25), 0 0 1px rgba(232,230,230,0.5); -webkit-box-shadow: inset 0 1px 2px rgba(34,25,25,0.25), 0 0 1px rgba(232,230,230,0.5);}#PREFIX_Button a strong {position: relative; line-height: 12px;}#PREFIX_Button a.thunderpin {margin-right: 0; border-right: none; width: 14px; padding: 5px 0 5px 4px; border-top-right-radius: 0; border-bottom-right-radius: 0; -webkit-border-top-right-radius: 0; -webkit-border-bottom-right-radius: 0; -moz-border-top-right-radius: 0; -moz-border-bottom-right-radius: 0; -ms-border-top-right-radius: 0; -ms-border-bottom-right-radius: 0; -o-border-top-right-radius: 0; -o-border-bottom-right-radius: 0;}#PREFIX_Button a.thunderpin em {background: url(ASSETS_URL/ActionIcons10.png?20120801) no-repeat -30px 0; position: relative; display: inline-block; width: 10px; height: 10px; top: 1px; left: -2px;}#PREFIX_Button a.thunderpin:hover em {background-image-postion: -30px -10px;}#PREFIX_Button a.thunderpin:active em {background-image-postion: -30px -20px;}#PREFIX_Button a.pin {left: 20px; width: 64px; margin-left: 0; *margin-left: -2px; border-top-left-radius: 0; border-bottom-left-radius: 0; -webkit-border-top-left-radius: 0; -webkit-border-bottom-left-radius: 0; -moz-border-top-left-radius: 0; -moz-border-bottom-left-radius: 0; -ms-border-top-left-radius: 0; -ms-border-bottom-left-radius: 0; -o-border-top-left-radius: 0; -o-border-bottom-left-radius: 0;}.PREFIX_Button_share {text-indent: -9999px; width: 68px; height: 24px; padding:0; background: url(ASSETS_URL/sharebutton_sprite.png?20121226) no-repeat 0 -80px !important; border: none;}.PREFIX_Button_share:hover {background-position: 0 -120px; background-position: 0 -120px !important;}.PREFIX_Button_share_top {background-position: 0 -80px; background-position: 0 -80px !important;}.PREFIX_Button_share_top:hover {background-position: 0 -120px; background-position: 0 -120px !important;}.PREFIX_Button_share_bottom {background-position: 0 0; background-position: 0 0 !important;}.PREFIX_Button_share_bottom:hover {background-position: 0 -40px; background-position: 0 -40px !important;}.PREFIX_thunder_tip { height: 16px; position: absolute; z-index: 999999999 !important; background: #000; background: rgba(0,0,0,0.5); color: #ddd; line-height: 16px; padding: 5px; border-radius: 2px; margin-left: 2px; }.PREFIXImagePreview .PREFIX_thunder_tip {height: 12px; line-height: 12px; padding: 10px; font-size: 14px; top: 50%; left: 50%; margin-left: -48px; margin-top: -18px;}.PREFIX_thunder_tip_success {color: #fff;font-weight: bold; height: 32px;}.PREFIX_thunder_tip p {font-weight: normal; text-align: center; margin-top: 2px;}.PREFIX_thunder_tip a {color: #fff;}.PREFIX_thunder_tip_failed {height: 32px; font-weight: bold; color: #fff;background: #c90000; background: rgba(201, 0, 0, .5); }.PREFIX_thunder_tip_failed p {margin: 0 2px; font-weight: normal; font-size: 12px;}.PREFIX_thunder_tip span { padding-left: 18px; position: relative;}.PREFIX_thunder_tip span em { background: url(ASSETS_URL/bm_pin_sprite.png?20120801) no-repeat 0px -150px; display: inline-block; height: 16px; width: 16px; position: absolute; left: 0; top: 50%; margin-top: -8px;}.PREFIX_thunder_tip_success span em { background: url(ASSETS_URL/bm_pin_sprite.png?20120801) no-repeat 0px -150px;}.PREFIX_thunder_tip_failed span em { background: url(ASSETS_URL/bm_pin_sprite.png?20120801) no-repeat -40px -150px;}.PREFIX_thunder_tip_ing span em { background: url(ASSETS_URL/thunder_motion.gif?20120801) no-repeat 2px 2px;}.PREFIXImagePreview .PREFIX_thunder_tip_failed {height: 32px; width: 140px; margin-left: -80px; margin-top: -26px;}.PREFIXImagePreview .PREFIX_thunder_tip_success {height: 32px; width: 88px; margin-left: -52px; margin-top: -26px;}.PREFIXImagePreview .PREFIX_thunder_tip_ing {width: 72px;}.PREFIXImagePreview .PREFIX_thunder_tip_success p, .PREFIXImagePreview .PREFIX_thunder_tip_failed p {margin-top: 9px; font-size: 12px; display: block;}".replace(/PREFIX/g,global).replace(/ASSETS_URL/g,imageRoot);var style=document.createElement("style");style.id=styleId;if(isIE()){style.type="text/css";style.media="screen"}if(style.styleSheet){style.styleSheet.cssText=styles}else{style.appendChild(document.createTextNode(styles))}(document.getElementsByTagName("head")[0]||document.body).appendChild(style)}function generateTag(name,tagName){var element=document.createElement(tagName||"div");element.id=global+"_"+name;return element}function encapsulateImage(img){var obj={w:img.naturalWidth||img.width,h:img.naturalHeight||img.height,src:img.src,img:img,alt:"",};return obj}function isValidImage(img){if(img.src&&img.src.indexOf("data:")==0){return false}if(img.style.display!="none"&&img.className!="ImageToPin"){if(img.width>=minWidth&&img.height>=minWidth){return true}}return false}function getCurrentPageImagesWithEncapsulation(d,eImages,opts){var _document=d||document;eImages=eImages||[];opts=opts||{};if(skip){return eImages}for(i=0;i<_document.images.length;i++){var img=_document.images[i];if(isValidImage(img)){img=encapsulateImage(img);if(opts){img._parentNode=opts.parentNode||null}eImages.push(img)}}var bgimgs_reg;for(i in bgimgs){bgimgs_reg=new RegExp(i);if(bgimgs_reg.test(location.href)){var imgs=bgimgs[i]();if(!imgs){break}for(var i=0;i<imgs.length;i++){if(isValidImage(imgs[i].img)){if(opts){imgs[i].img._parentNode=opts.parentNode||null}eImages.push(imgs[i])}}break}}var url=_document.location.href;var objects=_document.getElementsByTagName("object");var scripts=_document.getElementsByTagName("script");var thumb=new Image;if(url.indexOf("www.tudou.com")>0&&(_document.getElementById("playerObject")||_document.getElementById("tudouHomePlayer"))){var itemData;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("pic:")!=-1){var reg=/({[\s\S]*?cs:)/gmi;var m=reg.exec(scripts[i].innerHTML);if(m&&m[1]){try{itemData=eval("("+m[1]+"''})");break}catch(e){}}}}if(itemData){thumb.src=itemData.pic;thumb.width=320;thumb.height=240;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("playerObject")||_document.getElementById("tudouHomePlayer");var video="";if(!video&&!_document.getElementById("copyInput")){_document.getElementById("shareMore").click()}if(!_document.getElementById("copyInput").value){if(_document.getElementsByClassName("btn_share_flash").length>0){_document.getElementsByClassName("btn_share_flash")[0].click()}else{_document.getElementsByClassName("flash")[0].click()}}video=_document.getElementById("copyInput").value;if(video){thumb.video=video;thumb.media_type=1;eImages.push(thumb)}}}else{if(url.indexOf("www.bilibili.tv")>0){var datas=document.getElementsByTagName("meta");var pic="";var video="";for(var i=0;i<datas.length;i++){if(datas[i].getAttribute("itemprop")=="thumbnailUrl"){pic=datas[i].getAttribute("content");continue}if(datas[i].getAttribute("itemprop")=="embedURL"){video=datas[i].getAttribute("content");continue}}if(pic&&video){thumb.src=pic;thumb.width=120;thumb.height=90;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("bofqi");thumb.video=video;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("www.acfun.tv")>0){var pic;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("system.preview")!=-1){var reg=/system\.preview\s*=\s*(.+?);/;var m=reg.exec(scripts[i].innerHTML);if(m&&m[1]){try{pic=eval("("+m[1]+")");break}catch(e){}}}}var video="http://w5cdn.ranktv.cn/player/ACFlashPlayerX.3rd.20130407.swf?type=page&url="+url;if(pic&&video){thumb.src=pic;thumb.width=120;thumb.height=90;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("area-player");thumb.video=video;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.ku6.com")>0){var ObjectInfo;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("bigpicpath")!=-1){var reg=/App\s*=\s*(.+?);/;var m=reg.exec(scripts[i].innerHTML);if(m&&m[1]){try{ObjectInfo=eval("("+m[1]+")");break}catch(e){}}}}if(ObjectInfo){thumb.src=ObjectInfo.VideoInfo.data.data.bigpicpath;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("ku6player");thumb.video="http://player.ku6.com/refer/"+ObjectInfo.VideoInfo.id+"/v.swf";thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.163.com/special")>0||url.indexOf("v.163.com/movie")>0){var video;var vWidth;var vHeight;var reg;var m;var coverImg;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].textContent.indexOf("flashPlayer")!=-1){reg=/new flashPlayer\(\"(.+?)\",(\d+),(\d+)\);?/;m=reg.exec(scripts[i].textContent);if(m&&m[1]){video=m[1];vWidth=m[2];vHeight=m[3];break}}}if(video&&vWidth&&vHeight){reg=/-(vimg.+)-.swf?/;m=reg.exec(video);coverImg=m[1].replace(/_/g,".");coverImg="http://"+coverImg+".jpg";thumb.src=coverImg;thumb.width=vWidth;thumb.height=vHeight;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("flashArea");thumb.video=video;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.163.com/zixun")>0||url.indexOf("v.163.com/zongyi")>0||url.indexOf("v.163.com/jishi")>0){var video;var reg;var m;var coverImg;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].textContent.indexOf("flashPlayer")!=-1){reg=/data=\"(.+?)\"/;m=reg.exec(scripts[i].textContent);if(m&&m[1]){video=m[1];reg=/value=\"pltype(.+?)\"\s+name=\"flashvars\"/;m=reg.exec(scripts[i].textContent);video=video+"?pltype"+m[1];reg=/coverpic=(.+?)&/;m=reg.exec(scripts[i].textContent);coverImg=m[1];break}}}if(video&&coverImg){thumb.src=coverImg;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("FPlayer");thumb.video=video;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.yinyuetai.com")>0){var metas=_document.getElementsByTagName("meta");var image=false;var video=false;for(var i=0;i<metas.length;i++){if(metas[i].getAttribute("property")=="og:image"){image=metas[i].getAttribute("content")}if(metas[i].getAttribute("property")=="og:videosrc"){video=metas[i].getAttribute("content")}}if(url.indexOf("playlist")>0){var nodes=_document.getElementById("flashcopy").parentElement.childNodes;for(i=0;i<nodes.length;i++){if(nodes[i].value){video=nodes[i].value}}}if(image&&video){thumb.src=image;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("yinyuetaiplayer");thumb.video=video;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("www.iqiyi.com")>0||url.indexOf("yule.iqiyi.com")>0){var info;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("videoId")!=-1){eval(scripts[i].innerHTML)}if(info&&info.hasOwnProperty("videoId")){break}}if(info&&info.hasOwnProperty("videoId")){thumb.src="http://"+siteDomain+"/pins/create/video/qiyi/?id="+info.videoId;thumb.width=115;thumb.height=77;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("flash");thumb.video="http://player.video.qiyi.com/"+info.videoId;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("tv.sohu.com/201")>0&&_document.getElementById("shareBtn")){var ObjectInfo;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("cover")!=-1){var regCover=/\s*var\s*(cover\s*=.*)?;/;var mCover=regCover.exec(scripts[i].innerHTML);if(mCover&&mCover[1]){try{ObjectInfo=eval("("+mCover[1]+")");if(ObjectInfo){thumb.src=ObjectInfo;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("sohuplayer")}}catch(e){}}}if(!scripts[i].src&&scripts[i].innerHTML.indexOf("vid")!=-1&&thumb.src){var regVid=/\s*var\s*(vid\s*=.*)?;/;var mVid=regVid.exec(scripts[i].innerHTML);if(mVid&&mVid[1]){try{ObjectInfo=eval("("+mVid[1]+")");if(ObjectInfo){thumb.video="http://share.vrs.sohu.com/"+ObjectInfo+"/v.swf&autoplay=false";thumb.media_type=1}}catch(e){}}}if(thumb.src&&thumb.video){break}}eImages.push(thumb)}else{if(url.indexOf("my.tv.sohu.com")>0){var meta=_document.getElementsByTagName("meta");for(var i=0;i<meta.length;i++){if(meta[i].getAttribute("property")=="og:image"){thumb.src=meta[i].getAttribute("content");break}}thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("sohuplayer");for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("vid")!=-1&&thumb.src){var regVid=/\s*var\s*(vid\s*=.*)?;/;var mVid=regVid.exec(scripts[i].innerHTML);if(mVid&&mVid[1]){try{ObjectInfo=eval("("+mVid[1]+")");if(ObjectInfo){thumb.video="http://share.vrs.sohu.com/my/v.swf&topBar=1&id="+ObjectInfo+"&autoplay=false";thumb.media_type=1}}catch(e){}}}if(thumb.src&&thumb.video){break}}eImages.push(thumb)}else{if(url.indexOf("v.youku.com")>0){var videoId2;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("videoId2")!=-1){var reg=/var videoId2\s*=\s*'([^']+)';?/;var m=reg.exec(scripts[i].innerHTML);if(m&&m[1]){videoId2=m[1];break}}}if(videoId2){var json=eval("("+httpGet("http://v.youku.com/player/getPlayList/VideoIDS/"+videoId2)+")");thumb.src=json.data[0].logo;thumb.width=448;thumb.height=336;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("player");thumb.video="http://player.youku.com/player.php/sid/"+videoId2+"/v.swf";thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.ifeng.com")>0){var a=url.split("/");var id=a[a.length-1].split(".");id=id[0];var json=httpGet("http://v.ifeng.com/video_info_new/"+id[id.length-2]+"/"+id[id.length-2]+id[id.length-1]+"/"+id+".xml");var reg=/BigPosterUrl="(.+)" SmallPosterUrl/;var a=reg.exec(json);if(a&&a[1]){thumb.src=a[1];thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("playerDiv");thumb.video="http://v.ifeng.com/include/exterior.swf?guid="+id+"&AutoPlay=false";thumb.media_type=1;eImages.push(thumb)}}else{if(false&&url.indexOf("video.sina.com.cn")>0){var videoObj;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("video : {")!=-1){var json_str=scripts[i].innerHTML.replace("document.domain='sina.com.cn'","");json_str=json_str.replace(/\s*var\s*\$SCOPE\s*=\s*/,"");try{videoObj=eval("("+json_str+")");break}catch(e){}}}if(videoObj){thumb.src="http://"+siteDomain+"/pins/create/video/sina/?id="+videoObj.video.vid;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("myflashBox");thumb.video=videoObj.video.swfOutsideUrl;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("www.56.com/u")>0){var reg=/v_(.+?)\.html/;var a=reg.exec(url);if(a&&a[1]){a=a[1];thumb.src="http://"+siteDomain+"/pins/create/video/56/?id="+a;thumb.width=480;thumb.height=405;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("embed_flash_player");thumb.video="http://player.56.com/v_"+a+".swf";thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("www.jifenzhong.com/video")>0&&_document.getElementById("flash_url")){var json=httpGet("http://www.jifenzhong.com/playVideo.do?vid="+_document.getElementById("shortCommentVideoId").value);var reg=/<thumb_url>(.+)<\/thumb_url>/;var a=reg.exec(json);thumb.src=a[1];thumb.width=480;thumb.height=305;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("JifenzhongPlayer");thumb.video=_document.getElementById("flash_url").value;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("v.pptv.com/show")>0){var pptv_id;var reg;var m;for(var i=0;i<scripts.length;i++){if(!scripts[i].src&&scripts[i].innerHTML.indexOf("var webcfg")!=-1){reg=/var webcfg\s*=\s*{"id":(.+?),/;m=reg.exec(scripts[i].innerHTML);if(m&&m[1]){pptv_id=m[1];reg=/"swf"\s*:\s*"(.+?)"/;var temp=reg.exec(scripts[i].innerHTML);if(temp&&temp[1]){var pptv_swf=temp[1].replace(/\\/g,"");break}}}}if(pptv_id&&pptv_swf){thumb.src="http://"+siteDomain+"/pins/create/video/pptv/?id="+pptv_id;thumb.width=120;thumb.height=60;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("pptv_playpage_box");thumb.video=pptv_swf;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.qq.com")>0&&_document.getElementById("textfield2")){var video=_document.getElementById("textfield2").value;var reg=/vid=(.+)&/;var a=reg.exec(video);thumb.src="http://vpic.video.qq.com/76082551/"+a[1]+"_160_90_3.jpg";thumb.width=160;thumb.height=90;thumb=encapsulateImage(thumb);thumb.container=_document.getElementById("mod_player");thumb.video=video;thumb.media_type=1;eImages.push(thumb)}else{getVideoOnCustomerPage(_document,eImages)}}}}}}}}}}}}}}}}}var iframes=_document.getElementsByTagName("iframe");for(var i=0;i<iframes.length;i++){try{var d=iframes[i].contentDocument;if(d){var parentNode=iframes[i].parentNode;eImages=getCurrentPageImagesWithEncapsulation(d,eImages,{parentNode:parentNode})}}catch(e){}}return eImages}function httpGet(theUrl){var xmlHttp=null;xmlHttp=new XMLHttpRequest();xmlHttp.open("GET",theUrl,false);xmlHttp.send(null);return xmlHttp.responseText}function getVideoOnCustomerPage(doc,eImages){var _do_push=function(url,container){var thumb=new Image;if(url.indexOf("player.youku.com/player")>0||url.indexOf("www.tudou.com")>0||url.indexOf("player.ku6.com/refer")>0||url.indexOf("player.56.com")>0){thumb.src="http://"+siteDomain+"/pins/create/video/swf?url="+encodeURIComponent(url);thumb.width=448;thumb.height=336;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("share.vrs.sohu.com")>0){if(url.indexOf("share.vrs.sohu.com/my")>0){var reg=/share.vrs.sohu.com\/my\/v.swf.+?&id=(.+?)&autoplay=false/;var a=reg.exec(url);if(!a){return false}a=a[1];thumb.src="http://"+siteDomain+"/pins/create/video/mysohu/?id="+a;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{var reg=/share\.vrs\.sohu\.com\/(.+?)\/v\.swf/;var a=reg.exec(url);if(!a){return false}a=a[1];thumb.src="http://"+siteDomain+"/pins/create/video/sohu/?id="+a;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("v.ifeng.com/include/exterior.swf")>0){var reg=/guid=(.+?)&/;var a=reg.exec(url);if(a&&a[1]){a=a[1];thumb.src="http://"+siteDomain+"/pins/create/video/ifeng/?id="+a;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}}else{if(url.indexOf("manhua1.appsina.com")>0||url.indexOf("weibo.vmanhua.com")>0){thumb.src="http://"+siteDomain+"/pins/create/video/swf?url="+url;thumb.width=187;thumb.height=255;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("swf.ws.126.net/movieplayer")>0){var reg=/-(vimg.+)-.swf?/;var a=reg.exec(url);if(!a){return false}a=a[1];a=a.replace(/_/g,".");thumb.src="http://"+a+".jpg";thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("swf.ws.126.net/v")>0){var reg=/coverpic=\"(.+?)&/;var a=reg.exec(url);if(!a){return false}a=a[1];thumb.src=a;thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("player.yinyuetai.com")>0){var reg=/player\/(.+?)\//;var a=reg.exec(url);if(!a){return false}a=a[1];if(url.indexOf("video")>0){thumb.src="http://"+siteDomain+"/pins/create/video/yinyuetai/?id="+a}else{thumb.src="http://"+siteDomain+"/pins/create/video/yytList/?id="+a}thumb.width=480;thumb.height=360;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("player.video.qiyi.com")>0){var reg=/com\/(.+?)\//;var a=reg.exec(url);if(!a){return false}a=a[1];thumb.src="http://"+siteDomain+"/pins/create/video/qiyi/?id="+a;thumb.width=115;thumb.height=77;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("www.jifenzhong.com/external")>0){var reg=/v1.0\/(.+?)\/player/;var a=reg.exec(url);if(!a){return false}a=a[1];thumb.src="http://"+siteDomain+"/pins/create/video/jfz/?id="+a;thumb.width=480;thumb.height=305;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("player.pptv.com/v")>0){thumb.src="http://"+siteDomain+"/pins/create/video/swf?url="+url;thumb.width=120;thumb.height=60;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}else{if(url.indexOf("static.video.qq.com")>0){var reg=/vid=(.+)&/;var a=reg.exec(url);thumb.src="http://vpic.video.qq.com/76082551/"+a[1]+"_160_90_3.jpg";thumb.width=160;thumb.height=90;thumb=encapsulateImage(thumb);thumb.container=container;thumb.video=url;thumb.media_type=1;eImages.push(thumb)}}}}}}}}}}}};for(i=0;i<doc.embeds.length;i++){var embed=doc.embeds[i];if(tagName(embed.parentNode)=="object"){if(embed.src.indexOf("player.youku.com")<=0){continue}}var url=embed.src;var vars=embed.getAttribute("flashvars");if(vars&&url.indexOf("www.56.com")>0){vars=vars.split("&");var par;for(var i=0;i<vars.length;i++){par=vars[i].split("=");if(par[0]=="vid"){url="http://player.56.com/v_"+par[1]+".swf";break}}}_do_push(url,embed)}var objects=document.getElementsByTagName("object");for(i=0;i<objects.length;i++){if(tagName(objects[i].parentNode)=="object"){continue}var url=objects[i].__getElement("param[name=movie], param[name=src]");if(url){var container=objects[i];url=getAttribute(url,"value")||"";var vars=objects[i].__getElement("param[name=FlashVars]");if(vars&&url.indexOf("www.56.com")>0){vars=getAttribute(vars,"value").split("&");var par;for(var i=0;i<vars.length;i++){par=vars[i].split("=");if(par[0]=="vid"){url="http://player.56.com/v_"+par[1]+".swf";break}}}_do_push(url,container.parentNode||container)}}}function getSelectedText(){return(""+(window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection.createRange().text)).replace(/(^\s+|\s+$)/g,"")}function isIE(){return/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)}function isSafari(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)}function isPinable(showAlert){var pinable=true;var isLocal=false;var currentLocation=this.location;var currentHost=currentLocation.host;if(/^(?:about|chrome)/.test(currentLocation.protocol)){currentLocation.href="http://"+siteDomain;pinable=false}else{if(siteDomain==currentHost){if(!/^\/guide\/pin\/?/.test(currentLocation.pathname)){showAlert&&alert("你就在花瓣本站呢，不能采集本站图片。");pinable=false}}else{if(/^127.0.0.1(?::\d+)?/.test(currentHost)){isLocal=true}else{if(/^localhost(?::\d+)?/.test(currentHost)){isLocal=true}else{if(/^10\./.test(currentHost)){isLocal=true}else{if(/^192\.168\./.test(currentHost)){isLocal=true}else{if(/^(?:\d+\.){3}\d+$/.test(currentHost)){var e=currentHost.split("."),f=parseInt(e[0],10),e=parseInt(e[1],10);f===172&&e>15&&e<32?isLocal=true:f===169&&e===254&&(isLocal=true)}}}}}}}isLocal&&(showAlert&&alert("你现在访问的是内部网络，不能采集内网图片。"),pinable=false);return pinable}function pinImage(eImage,thunder){for(i in filters){var reg=new RegExp(i);if(reg.test(location.href)){eImage=filters[i](eImage)||eImage;break}}var pinUrl=eImage.url||(eImage.src==location.href?document.referrer||location.href:location.href);var originImg=eImage.img;var host=originImg.src.match("^https?://(.*?)/");host=host[1];if(host.indexOf("taobaocdn.com")>-1){originImg.src=originImg.src.replace(/_310x310.jpg/,"")}if(isSafari()){pinUrl=encodeURI(pinUrl)}var _img=eImage.big_img?eImage.big_img:originImg;var image={media:(eImage.big_img?eImage.big_img.src:originImg.src),url:pinUrl,w:_img.naturalWidth||_img.width,h:_img.naturalHeight||_img.height,alt:originImg.alt,title:eImage.title||document.title,description:eImage.description||"",media_type:eImage.media_type||"",video:eImage.video||""};imageDesc=getSelectedText()||selectedText;if(imageDesc){image.description=imageDesc}var pinUrlComponents=[];pinUrlComponents.push(bookmarkletUrl);pinUrlComponents.push("?");if(thunder&&typeof thunder==="function"){return thunder(image)}for(var p in image){pinUrlComponents.push(encodeURIComponent(p));pinUrlComponents.push("=");pinUrlComponents.push(encodeURIComponent(image[p]));pinUrlComponents.push("&")}pinUrlComponents.push("via=7&");if(isShareBtn){pinUrlComponents.push("is_share_btn=1&")}var pinUrl=pinUrlComponents.join("");var features="status=no,resizable=no,scrollbars=yes,personalbar=no,directories=no,location=no,toolbar=no,menubar=no,width=632,height=270,left=0,top=0";chrome.extension.sendRequest({msg:"ga",type:"pinBtn",value:"pin"},function(response){});window.open(pinUrl,"pin"+(new Date).getTime(),features)}function thunderpinImage(eImage,divImagePreview,position,callback){callback=typeof callback==="function"?callback:function(){};checkLogin(function(){if(!isLogin){requireLogin();return callback()}else{pinImage(eImage,function(image){if(thunderpin_state(eImage,divImagePreview,position,"ing")){return callback()}var data={text:image.description||image.title||image.alt||"",link:image.url||"",img_url:image.media,media_type:image.media_type,video:image.video||"",is_share_btn:isShareBtn?1:""};xdm&&xdm.request&&xdm.request({url:"/pins/",data:data,noCache:true,method:"post"},function(res){if(res.err){thunderpin_state(eImage,divImagePreview,position,"failed",res.msg);return callback()}var msg='<a href="http://'+siteDomain+"/pins/"+res.pin.pin_id+'/" target="_blank;">查看采集</a>';thunderpin_state(eImage,divImagePreview,position,"success",msg);return callback()},function(){thunderpin_state(eImage,divImagePreview,position,"failed");return callback()})})}})}function thunderpin_state(eImage,divImagePreview,position,state,msg){var originImg=eImage.container||eImage.img;var thunder_id=originImg.getAttribute("data-thunder");if(state=="ing"&&thunder_id){return true}var timer,tip;if(!thunder_id){thunder_id=Math.floor(new Date()/1000);originImg.setAttribute("data-thunder",thunder_id);tip=generateTag((divImagePreview?"p_":"")+thunder_id);if(divImagePreview){divImagePreview.appendChild(tip)}else{document.body.appendChild(tip)}}else{return setTimeout(function(){tip=document.getElementById(global+"_"+(divImagePreview?"p_":"")+thunder_id);originImg.setAttribute("data-thunder","");tip&&tip.parentNode&&tip.parentNode.removeChild(tip);thunderpin_state(eImage,divImagePreview,position,state,msg)},500)}if(isIE()){tip.className=global+"_thunder_tip "+global+"_thunder_tip_"+state}else{tip.setAttribute("class",global+"_thunder_tip "+global+"_thunder_tip_"+state)}msg=msg||"";var summary=state=="success"?"采集成功！":state=="ing"?"采集中…":"采集失败！";tip.innerHTML="<span><em></em>"+summary+"</span><p>"+msg+"</p>";if(!divImagePreview){tip.style.top=position.top;tip.style.left=position.left;if(state=="success"||state=="failed"){tip.style.top=(parseInt(position.top)-16)+"px"}}tip.onmouseover=function(){clearTimeout(timer)};tip.onmouseout=function(){hideTip()};function hideTip(){if(state=="success"||state=="failed"){timer=setTimeout(function(){originImg.setAttribute("data-thunder","");tip&&tip.parentNode&&tip.parentNode.removeChild(tip)},3000)}}hideTip();return false}function hideTips(){var tips=document.body.__getElements("."+global+"_thunder_tip");for(var i=0;i<tips.length;i+=1){tips[i].style.display="none"}}function hideFlash(){var id=global+"_FixFlashStyle";if(!document.getElementById(id)){var style_text="object, embed {visibility: hidden; display:none;}",style_el=document.createElement("style");style_el.id=id;(document.getElementsByTagName("head")[0]||document.body).appendChild(style_el);style_el.styleSheet?style_el.styleSheet.cssText=style_text:style_el.appendChild(document.createTextNode(style_text))}}function showFlash(){var s=document.getElementById(global+"_FixFlashStyle");if(s){(document.getElementsByTagName("head")[0]||document.body).removeChild(s)}}function showImages(eImages){if(showingImage){return}hideTips();lastScrollY=window.pageYOffset||document.body.scrollTop;var clearPage=function(){divOverlay.parentNode.removeChild(divOverlay);divContainer.parentNode.removeChild(divContainer);showingImage=false;selectedText="";window.scroll(0,lastScrollY);return false};var divOverlay=generateTag("Overlay");document.keydown=clearPage;document.body.appendChild(divOverlay);var divContainer=generateTag("Container");document.body.appendChild(divContainer);var divControl=generateTag("Control");var imgLogo=document.createElement("div");imgLogo.setAttribute("style","background: url("+imageRoot+"/LogoAbout.png) no-repeat; width: 150px; height: 59px; margin: 70px auto;");divControl.appendChild(imgLogo);var lnkRemove=generateTag("RemoveLink","a");lnkRemove.href="javascript:;";lnkRemove.appendChild(document.createTextNode("关闭"));divControl.appendChild(lnkRemove);divContainer.appendChild(divControl);var closeEl=document.getElementById(global+"_RemoveLink");closeEl.onclick=clearPage;var imageSrcMap={};for(var i=0;i<eImages.length;i++){if(!imageSrcMap[eImages[i].src]){imageSrcMap[eImages[i].src]=1;(function(eImage){var divImagePreview_inner;var divImagePreview=document.createElement("div");if(isIE()){divImagePreview.className=global+"ImagePreview"}else{divImagePreview.setAttribute("class",global+"ImagePreview")}var divImageContainer=document.createElement("div");if(isIE()){divImageContainer.className=global+"Img"}else{divImageContainer.setAttribute("class",global+"Img")}var spnDimensions=document.createElement("span");spnDimensions.innerHTML=eImage.w+" x "+eImage.h;if(isIE()){spnDimensions.className=global+"Dimensions"}else{spnDimensions.setAttribute("class",global+"Dimensions")}divImagePreview.appendChild(spnDimensions);document.getElementById(global+"_Container").appendChild(divImagePreview).appendChild(divImageContainer);divImagePreview_inner=document.createElement("a");divImagePreview_inner.setAttribute("href","javascript:;");if(eImage.video){var videoSpan=document.createElement("span");if(isIE()){videoSpan.className=global+"VideoIcon"}else{videoSpan.setAttribute("class",global+"VideoIcon")}divImagePreview_inner.appendChild(videoSpan)}divImageContainer.appendChild(divImagePreview_inner);var imgImage=document.createElement("img");if(isIE()){divImageContainer.className=global+"Img"}else{divImageContainer.setAttribute("class",global+"Img")}imgImage.setAttribute("style",""+calculateMarginTop(eImage));imgImage.src=eImage.src;imgImage.setAttribute("alt","Pin This");imgImage.className="ImageToPin";divImagePreview_inner.appendChild(imgImage);var _tpin=document.createElement("strong");var _pin=document.createElement("strong");if(isIE()){_tpin.className=global+"_ThunderPin";_pin.className=global+"_Pin"}else{_tpin.setAttribute("class",global+"_ThunderPin");_pin.setAttribute("class",global+"_Pin")}_tpin.setAttribute("title","快速采集");_pin.setAttribute("title","采集到花瓣");_tpin.onclick=function(){thunderpinImage(eImage,divImagePreview);return};_pin.onclick=function(){pinImage(eImage);return clearPage()};if(isIE()){divImagePreview_inner.attachEvent("onmouseover",function(){_tpin.style.display="block";_pin.style.display="block"});divImagePreview_inner.attachEvent("onmouseout",function(){_tpin.style.display="none";_pin.style.display="none"})}else{divImagePreview_inner.addEventListener("mouseover",function(){_tpin.style.display="block";_pin.style.display="block"},false);divImagePreview_inner.addEventListener("mouseout",function(){_tpin.style.display="none";_pin.style.display="none"},false)}divImagePreview_inner.appendChild(_tpin);divImagePreview_inner.appendChild(_pin)})(eImages[i])}}showingImage=true}function initPinBtn(eImages){generatePinBtn();registerImagesForPinBtn(eImages)}var reported=false;function showImagesAndInitPinBtn(){if(!isPinable(true)){return}var currentPageEImages=getCurrentPageImagesWithEncapsulation();imageDesc=getSelectedText()||selectedText;if(currentPageEImages.length==0){if(!reported){reported=true;var link=location.href;var req=new Image();req.src="http://"+siteDomain+"/feedback/objnotfound?link="+encodeURIComponent(link)}try{if(window.top===window.self){window.alert("抱歉，页面上没有足够大的图片。")}}catch(e){}}else{showImages(currentPageEImages);initPinBtn(currentPageEImages);window.scroll(0,0)}}function setToggleOn(toggle){isToggleOn=!!toggle}function getToggleOn(callback){chrome.extension.sendRequest({msg:"isToggleOn"},function(response){callback(!!response.isToggleOn)})}function checkLogin(callback){chrome.extension.sendRequest({msg:"isLogin"},function(response){if(response&&response.user){isLogin=true}else{isLogin=false}if(typeof callback==="function"){callback()}})}function initXDM(){xdm={request:function(data,success,failed){chrome.extension.sendRequest({msg:"request",data:data},function(response){if(response.msg=="success"){success(response.data)}else{failed(response.data)}})}};checkLogin()}function requireLogin(){chrome.extension.sendRequest({msg:"requireLogin"},function(response){})}(function(){if(document[global]._loaded){return}document.body.addEventListener("DOMNodeInserted",function(e){domChanged=true;clearTimeout(timer);timer=setTimeout(check,500)});window.addEventListener("scroll",function(){domChanged=true;clearTimeout(timer);timer=setTimeout(check,500)});var timer=false;var check=function(){if(!domChanged){return}chrome.extension.sendRequest({msg:"minWidth"},function(response){minWidth=response.minWidth;var currentPageEImages=getCurrentPageImagesWithEncapsulation();if(currentPageEImages.length>0){initPinBtn(currentPageEImages)}domChanged=false;timer=setTimeout(check,5000)})};if(isIE()){document.body.attachEvent("onclick",function(){var e=window.event;if(e.target&&e.target.tagName=="pinit"){return}domChanged=true;clearTimeout(timer);timer=setTimeout(check,500)})}else{document.body.addEventListener("click",function(e){if(e.target&&e.target.tagName=="pinit"){return}if(e.target&&tagName(e.target)=="img"&&e.target.parentNode){itemUrl=getAttribute(e.target.parentNode,"data-content-url")}domChanged=true;clearTimeout(timer);timer=setTimeout(check,500)})}if(isPinable(false)){generateStyleElement();domChanged=true;check()}if(document.getElementById("huaban_share_script")){isShareBtn=true;var btnPosition=document.getElementById("huaban_share_script").getAttribute("data-position")||"";btnPositions=btnPosition.split(" ")}if(isShareBtn){try{var iframe=document.createElement("iframe");iframe.setAttribute("src",analyticsUrl);iframe.style.width="0px";iframe.style.height="0px";iframe.style.display="none";window.document.body.appendChild(iframe)}catch(e){}}initXDM();document[global]._loaded=true;document[global].showValidImages=showImagesAndInitPinBtn;document[global].pinImage=pinImage;document[global].setToggleOn=setToggleOn})()})();