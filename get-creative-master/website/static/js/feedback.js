// Generated by CoffeeScript 1.4.0
(function() {

  window.show_form_feedback = function(parent_node, message, highlight_nodes, disable_submit) {
    var inputs, invalid_count, message_node, submit_button;
    if (disable_submit == null) {
      disable_submit = true;
    }
    inputs = parent_node.find('input[type=text], input[type=password]');
    inputs.removeClass("invalid");
    inputs.off(".validation_check");
    message_node = parent_node.find('span.form_feedback');
    message_node.text(message);
    message_node.slideDown(100);
    invalid_count = highlight_nodes.length;
    if (invalid_count) {
      highlight_nodes.each(function(_, node) {
        node = $(node);
        node.addClass("invalid");
        return node.one("keydown.validation_check", function() {
          $(this).removeClass("invalid");
          invalid_count -= 1;
          if (invalid_count === 0 && disable_submit) {
            submit_button.attr("disabled", false);
            return message_node.slideUp(100, function() {
              return $(this).text("");
            });
          }
        });
      });
    }
    if (disable_submit && invalid_count) {
      submit_button = parent_node.find('button.submit');
      return submit_button.attr("disabled", true);
    }
  };

  window.show_error = function(error_message) {
    var body, close_modal, left, message_p, modal, modal_height, modal_overlay, modal_width, top_start, top_wait, window_height, window_width;
    window.track_event('error', 'shown_error_message', error_message);
    modal = $('#modal');
    modal_overlay = $('#modal_overlay');
    message_p = modal.find("p");
    message_p.html("" + error_message + "\n<br><br>\nIf this problem persists. Please contact\n<a href=\"mailto:support@get-creative.us\" class=\"js_external_link\">support@get-creative.us</a>.");
    body = $('body');
    body.addClass("modal_is_active");
    modal_width = modal.outerWidth();
    modal_height = modal.outerHeight();
    window_width = $(window).width();
    window_height = $(window).height();
    left = (window_width - modal_width) / 2;
    top_start = 0;
    top_wait = (window_height - modal_height) / 2;
    modal.css({
      left: left,
      top: top_start + "px",
      opacity: 0
    }).show();
    modal.animate({
      top: top_wait + "px",
      opacity: 1
    }, {
      duration: 500,
      easing: "linear",
      complete: function() {
        modal.find(".close_modal").on("click.modal", close_modal);
        return modal_overlay.one("click.modal", close_modal);
      }
    });
    close_modal = function() {
      var top_end;
      window_height = $(window).height();
      top_end = window_height - modal_height;
      return modal.animate({
        top: top_end,
        opacity: 0
      }, {
        duration: 300,
        easing: "linear",
        complete: function() {
          body.removeClass("modal_is_active");
          modal.hide();
          message_p.text("");
          modal.off(".modal");
          return modal_overlay.off(".modal");
        }
      });
    };
  };

}).call(this);
