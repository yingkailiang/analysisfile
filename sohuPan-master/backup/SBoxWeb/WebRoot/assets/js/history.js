jQuery(function(){$("#mainOp").on("click",".uploadnew",function(){Sbox.Upload(resourceId,"update")});var d=$("#fileList"),e=d.find(".list-item");d.on("mouseenter",".list-item",function(){$(this).addClass("hover")}).on("mouseleave",".list-item",function(){$(this).removeClass("hover")});var b=[],f;e.each(function(d,e){var a=$(e),h=a.attr("data-version"),i=a.attr("data-id"),c=a.attr("data-name"),g=1*a.attr("data-size"),j=a.attr("data-key"),k=getFileType(c);isPreviewImgFile(c,g)?(b.push({id:i,name:c,
size:g,key:j}),a.find(".file-name a, .file-icon a").attr("href","javascript:;")):previewFileType.test(k)||a.find(".file-name a, .file-icon a").attr("href","javascript:;");a.on("click",".file-name a, .file-icon a",function(){if(isPreviewImgFile(c,g)){for(var a=0,l=b.lenght;a<l;a++)if(i===b[a].id){f=a;break}window.imgPreviewHandle?window.imgPreviewHandle.rebuild({index:f,imgs:b}):window.imgPreviewHandle=new Sbox.Views.ImgPreview({index:f,imgs:b})}}).on("click",".replace",function(){Sbox.Warning({title:"\u66ff\u6362\u7248\u672c",
message:"\u786e\u8ba4\u66ff\u6362\u4e3a\u6700\u65b0\u7248\u672c\uff1f",callback:function(a){a&&$.post("/FileVersion!switchVersion.action",{resourceId:resourceId,version:h},function(a){if(a.code===701)Sbox.Login();else if(a.code===200){Sbox.Success("\u7248\u672c\u66ff\u6362\u6210\u529f");setTimeout(function(){location.reload()},1E3)}else Sbox.Fail("\u7248\u672c\u66ff\u6362\u5931\u8d25")},"json").error(function(){Sbox.Loading().remove();Sbox.Error("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5")})}})}).on("click",
".download",function(){}).on("click",".del",function(){Sbox.Warning({title:"\u5220\u9664\u7248\u672c",message:"\u786e\u5b9a\u5220\u9664\u5f53\u524d\u7248\u672c\uff1f",callback:function(b){b&&$.post("/DeleteVersion!deleteVersion.action",{resourceId:resourceId,versionNumber:h},function(b){if(b.code===701)Sbox.Login();else if(b.code===200){Sbox.Success("\u7248\u672c\u5220\u9664\u6210\u529f");a.remove();setTimeout(function(){location.reload()},1E3)}else Sbox.Fail("\u7248\u672c\u5220\u9664\u5931\u8d25")},
"json").error(function(){Sbox.Loading().remove();Sbox.Error("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5")})}})})})});
