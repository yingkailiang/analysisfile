Sbox.Controllers.Router=Backbone.Router.extend({routes:{"":"home","!/\u6211\u7684\u6587\u4ef6*actions":"netdisk","!/\u4f01\u4e1a\u5171\u4eab*actions":"publicdisk","!/\u5171\u4eab\u6587\u4ef6*actions":"share","!/\u5916\u94fe\u7ba1\u7406/:type":"outchain","!/\u56de\u6536\u7ad9":"recyclebin","*actions":"defaultAction"},initialize:function(){var a=this;new Sbox.Views.Layout;Sbox.RefreshUsage();$(window).bind("resize",function(){a.resize()})},home:function(){Backbone.history.navigate("!/"+MY_DISK_NAME,
!0)},defaultAction:function(a){if(!this.loaded){try{if(decodeURIComponent(a)===a){Backbone.history.navigate("",!0);return}Backbone.history.navigate(decodeURIComponent(a),!0)}catch(b){Backbone.history.navigate("",!0)}this.loaded=!0}},netdisk:function(a){if(""!==a&&0!==a.indexOf("/"))Backbone.history.navigate("!/"+MY_DISK_NAME,!0);else{this.reset();this.myFilePathModel=this.myFilePathModel||new Sbox.Models.Path({type:"mine"});this.myFileList=this.myFileList||new Sbox.Collections.FileList([],{type:"mine"});
this.myFileView=this.myFileView||new Sbox.Views.MyFileView({path:this.myFilePathModel,fileList:this.myFileList});this.myFileTree=this.myFileTree||new Sbox.Views.TreeView({el:$("#myFileBody"),path:this.myFilePathModel,fileList:this.myFileList,type:"mine"});this.myFileView.$el.show();$("#sidebar .mine").addClass("on");this.resize();"/"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));var a="/"+MY_DISK_NAME+a,b=this.myFilePathModel;b.set({path:a},{silent:!0});b.trigger("change")}},share:function(a){if(""!==
a&&0!==a.indexOf("/"))Backbone.history.navigate("!/"+MY_DISK_NAME,!0);else{this.reset();this.shareFilePathModel=this.shareFilePathModel||new Sbox.Models.Path({type:"share"});this.shareFileList=this.shareFileList||new Sbox.Collections.FileList([],{type:"share"});this.shareFileView=this.shareFileView||new Sbox.Views.ShareFileView({path:this.shareFilePathModel,fileList:this.shareFileList});this.shareFileTree=this.shareFileTree||new Sbox.Views.TreeView({el:$("#shareFileBody"),path:this.shareFilePathModel,
fileList:this.shareFileList,type:"share"});this.shareFileView.$el.show();$("#sidebar .shared").addClass("on");this.resize();"/"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));var a="/"+SHARE_DISK_NAME+a,b=this.shareFilePathModel;b.set({path:a},{silent:!0});b.trigger("change")}},publicdisk:function(a){if(""!==a&&0!==a.indexOf("/"))Backbone.history.navigate("!/"+PUBLIC_DISK_NAME,!0);else{this.reset();this.publicFilePathModel=this.publicFilePathModel||new Sbox.Models.Path({type:"public"});this.publicFileList=
this.publicFileList||new Sbox.Collections.FileList([],{type:"public"});this.publicFileView=this.publicFileView||new Sbox.Views.PublicFileView({path:this.publicFilePathModel,fileList:this.publicFileList});this.publicFileTree=this.publicFileTree||new Sbox.Views.TreeView({el:$("#publicFileBody"),path:this.publicFilePathModel,fileList:this.publicFileList,type:"public"});this.publicFileView.$el.show();$("#sidebar .public").addClass("on");this.resize();"/"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-
1));var a="/"+PUBLIC_DISK_NAME+a,b=this.publicFilePathModel;b.set({path:a},{silent:!0});b.trigger("change")}},outchain:function(a){this.reset();$("#sidebar .outchain").addClass("on");$("#sidebar .outchain li").removeClass("cur");"outlink"===a?($("#sidebar .outchain .outlink").addClass("cur"),this.linkList=this.linkList||new Sbox.Collections.FileList([],{type:"outchain"}),this.linkView=this.linkView||new Sbox.Views.LinkView({fileList:this.linkList}),this.linkView.$el.show(),this.linkList.fetch({data:{_t:Math.random()}})):
"uploadlink"===a?($("#sidebar .outchain .uploadlink").addClass("cur"),this.uploadlinkList=this.uploadlinkList||new Sbox.Collections.FileList([],{type:"uploadlink"}),this.uploadlinkView=this.uploadlinkView||new Sbox.Views.UploadLinkView({fileList:this.uploadlinkList}),this.uploadlinkView.$el.show(),this.uploadlinkList.fetch({data:{_t:Math.random()}})):Backbone.history.navigate("!/"+OUT_CHAIN+"/outlink",!0);this.resize()},recyclebin:function(){this.reset();this.recycleList=this.recycleList||new Sbox.Collections.FileList([],
{type:"recyclebin"});this.recicleView=this.recicleView||new Sbox.Views.RecycleView({fileList:this.recycleList});this.recicleView.$el.show();$("#sidebar .recyclebin").addClass("on");this.resize();this.recycleList.fetch({data:{_t:Math.random()}})},log:function(){},reset:function(){this.myFileView&&this.myFileView.$el.hide();this.publicFileView&&this.publicFileView.$el.hide();this.shareFileView&&this.shareFileView.$el.hide();this.linkView&&this.linkView.$el.hide();this.uploadlinkView&&this.uploadlinkView.$el.hide();
this.recicleView&&this.recicleView.$el.hide();$("#sidebar .on").removeClass("on")},resize:function(){var a=$("#sidebar .mod-bd"),b=$("#main .my-file .list-body,#main .share-file .list-body,,#main .public-file .list-body"),e=$("#main .outchain .list-body"),f=$("#main .recyclebin .list-body"),g=$("#sidebar"),i=$("#main .navigation"),c=$(window).height(),h=$(window).width(),d=$("#header").outerHeight(!0),j=c-d-46*$("#sidebar .mod").length-88,k=c-d-48-48-46,l=c-d-48,m=c-d-36-48-48,c=c-d-107;a[0]&&_(a).each(function(a){$(a).height(j)});
b[0]&&_(b).each(function(a){$(a).height(k)});e[0]&&e.height(l);f[0]&&f.height(m);g[0]&&g.height(c);i.width((1E3<h?h:1E3)-570)}});$(document).ready(function(){new Sbox.Controllers.Router;Backbone.history.start()});
